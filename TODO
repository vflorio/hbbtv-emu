packages
    extensions
        chrome-v3 
        chrome-v2
        chrome-v1
        firefox-v3
    runtimes
        chrome
        firefox
        web
    core
        message-bus
        storage
        scheduler
        logger
    hbbtv 
    demos
    hbbtv-api
    ui


HBBTV
    - il pacchetto hbbtv deve esportare una classe composta per ogni versione
        1.7.1
        1.6.1
        1.5.1
        1.4.1
        1.3.1
        1.2.1
        1.1.1

    - il codice che integra l'interfaccia di hbbtv con il resto del codice dovrebbe essere isolato

Runtimes 
    Una runtime deve isolare tutto quello che funziona dietro un contesto specifico

Extensions
    L'estensione implementa tutto il necessario per far passare i dati fra UI, API, Storage, etc, sfruttando la runtime


    Chrome V3 
        - bisogna combinare il content-script con user-agent-inject, quindi il chrome script inject, non serve piÃ¹ 

Flusso: 
    - Il browser esegue il background-script e il sidepanel
    - quando viene caricata una pagina web, il manifest carica al document start il bridge,
      esso determina se siamo in una pagina hbbtv, se non lo siamo termina, altrimenti si avvia (permettendo comunicazione tra content e background), dispatchando l'evento BRIDGE_SCRIPT_READY, quando ricevuto dal background, viene iniettato il content-script nella tab,
    - il content-script invia il CONTENT_SCRIPT_READY sia al background, ed esso invia un messaggio "UPDATE_BRIDGE_CONTEXT"
      con il tabID da impostare per i futuri messaggi.
     - a questo punto si il content inizializza dom observer + element matchers


Matcher = {querySelector}

HBBTV Version -> matchers[] 

oipf = [
    ApplicationManager: <object type=application/oipfApplicationManager />
    Configuration: <object type=application/oipfConfiguration />
    Capabilities: <object type=application/oipfCapabilities />
]

av = [
    VideoBroadcast: <object type=video/broadcast />s
    VideoMp4: <object type=video/mp4 />
    VideoDash: <object type=video/dash+xml />
]

HTMLDashSource <video><source type="video/dash+xml"></video>

HBBTV 1.6.1 -> matchers [ ...oipf, ...av, HTMLDashSource ]
HBBTV 1.3.1 -> matchers [ ...oipf, ...av, HTMLDashSource ]
HBBTV 1.2.1 -> matchers [ ...oipf, ...av ]


REFACTOR TODO:
    - A/V Control Objects
    - Video Backend
    - Connettere il provider alla config 